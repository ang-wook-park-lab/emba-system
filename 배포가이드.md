# ğŸš€ ë°°í¬ ê°€ì´ë“œ (í•œêµ­ì–´)

## ğŸ“‹ ë°°í¬ ì „ ì¤€ë¹„ì‚¬í•­

### 1. í•„ìˆ˜ ìš”êµ¬ì‚¬í•­
- Node.js 18 ì´ìƒ ì„¤ì¹˜
- npm ë˜ëŠ” yarn ì„¤ì¹˜
- ì„œë²„ ì ‘ê·¼ ê¶Œí•œ (SSH ë“±)

### 2. í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±

`backend/.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”:

```env
PORT=5000
NODE_ENV=production
JWT_SECRET=ê°•ë ¥í•œ-ë¹„ë°€í‚¤-ì—¬ê¸°ì—-ì…ë ¥-ë³€ê²½í•„ìˆ˜
JWT_EXPIRE=7d
```

âš ï¸ **ì¤‘ìš”**: `JWT_SECRET`ì€ ë°˜ë“œì‹œ ê°•ë ¥í•œ ëœë¤ ë¬¸ìì—´ë¡œ ë³€ê²½í•˜ì„¸ìš”!

## ğŸ¯ ë°©ë²• 1: ë‹¨ì¼ ì„œë²„ ë°°í¬ (ê°€ì¥ ê°„ë‹¨)

### ë‹¨ê³„ë³„ ë°°í¬ ê³¼ì •

#### 1ë‹¨ê³„: ì„œë²„ì— íŒŒì¼ ì—…ë¡œë“œ

ì„œë²„ì— ì ‘ì†í•œ í›„ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”:

```bash
# ì˜ˆ: SCPë¥¼ ì‚¬ìš©í•œ ì—…ë¡œë“œ
scp -r kyungheewonwoo user@your-server.com:/home/user/

# ë˜ëŠ” FTP, Git ë“±ì„ ì‚¬ìš©
```

#### 2ë‹¨ê³„: ì„œë²„ì—ì„œ ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# ì„œë²„ì— SSH ì ‘ì†
ssh user@your-server.com

# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /home/user/kyungheewonwoo

# í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ
cd frontend
npm install
npm run build

# ë°±ì—”ë“œ ì˜ì¡´ì„± ì„¤ì¹˜
cd ../backend
npm install --production
```

#### 3ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
cd backend
nano .env  # ë˜ëŠ” vi .env
```

`.env` íŒŒì¼ì— ë‹¤ìŒ ë‚´ìš© ì…ë ¥:
```env
PORT=5000
NODE_ENV=production
JWT_SECRET=your-strong-secret-key-here
JWT_EXPIRE=7d
```

#### 4ë‹¨ê³„: ë””ë ‰í† ë¦¬ ê¶Œí•œ ì„¤ì •

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë° ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ìƒì„± ë° ê¶Œí•œ ì„¤ì •
mkdir -p backend/data backend/uploads/receipts
chmod 755 backend/data backend/uploads
```

#### 5ë‹¨ê³„: ì„œë²„ ì‹¤í–‰

```bash
cd backend
NODE_ENV=production npm start
```

#### 6ë‹¨ê³„: ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ (ì„ íƒì‚¬í•­)

ì„œë²„ë¥¼ ì¢…ë£Œí•´ë„ ê³„ì† ì‹¤í–‰ë˜ë„ë¡ í•˜ë ¤ë©´:

```bash
# nohup ì‚¬ìš©
nohup NODE_ENV=production npm start > server.log 2>&1 &

# ë˜ëŠ” screen ì‚¬ìš©
screen -S emba-server
NODE_ENV=production npm start
# Ctrl+A, Dë¡œ detach
```

---

## ğŸ”§ ë°©ë²• 2: PM2ë¥¼ ì‚¬ìš©í•œ ë°°í¬ (ê¶Œì¥)

PM2ëŠ” í”„ë¡œì„¸ìŠ¤ ë§¤ë‹ˆì €ë¡œ, ì„œë²„ê°€ ìë™ìœ¼ë¡œ ì¬ì‹œì‘ë˜ê³  ë¡œê·¸ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 1ë‹¨ê³„: PM2 ì„¤ì¹˜

```bash
npm install -g pm2
```

### 2ë‹¨ê³„: PM2ë¡œ ì„œë²„ ì‹¤í–‰

```bash
cd backend
NODE_ENV=production pm2 start server.js --name "emba-backend"
```

### 3ë‹¨ê³„: PM2 ì„¤ì • ì €ì¥

```bash
# í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì €ì¥
pm2 save

# ì‹œìŠ¤í…œ ë¶€íŒ… ì‹œ ìë™ ì‹œì‘ ì„¤ì •
pm2 startup
# ì¶œë ¥ëœ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”
```

### 4ë‹¨ê³„: PM2 ëª…ë ¹ì–´

```bash
# ìƒíƒœ í™•ì¸
pm2 status

# ë¡œê·¸ í™•ì¸
pm2 logs emba-backend

# ì¬ì‹œì‘
pm2 restart emba-backend

# ì¤‘ì§€
pm2 stop emba-backend

# ì‚­ì œ
pm2 delete emba-backend
```

### 5ë‹¨ê³„: PM2 ì„¤ì • íŒŒì¼ ìƒì„± (ì„ íƒì‚¬í•­)

`backend/ecosystem.config.js` íŒŒì¼ ìƒì„±:

```javascript
module.exports = {
  apps: [{
    name: 'emba-backend',
    script: 'server.js',
    instances: 1,
    exec_mode: 'fork',
    env: {
      NODE_ENV: 'production',
      PORT: 5000
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss Z',
    merge_logs: true,
    autorestart: true,
    watch: false,
    max_memory_restart: '1G'
  }]
}
```

ì‚¬ìš©:
```bash
pm2 start ecosystem.config.js
```

---

## ğŸ³ ë°©ë²• 3: Dockerë¥¼ ì‚¬ìš©í•œ ë°°í¬

### 1ë‹¨ê³„: Dockerfile ìƒì„±

`backend/Dockerfile` íŒŒì¼ ìƒì„±:

```dockerfile
FROM node:18-alpine

WORKDIR /app

# ë°±ì—”ë“œ ì˜ì¡´ì„± ì„¤ì¹˜
COPY backend/package*.json ./
RUN npm install --production

# ë°±ì—”ë“œ ì†ŒìŠ¤ ë³µì‚¬
COPY backend/ ./

# í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ íŒŒì¼ ë³µì‚¬
COPY frontend/dist ../frontend/dist

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 5000

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
ENV NODE_ENV=production

# ì„œë²„ ì‹¤í–‰
CMD ["node", "server.js"]
```

### 2ë‹¨ê³„: .dockerignore íŒŒì¼ ìƒì„±

`backend/.dockerignore`:
```
node_modules
npm-debug.log
.env
data
uploads
```

### 3ë‹¨ê³„: Docker ì´ë¯¸ì§€ ë¹Œë“œ

```bash
# í”„ë¡ íŠ¸ì—”ë“œ ë¨¼ì € ë¹Œë“œ
cd frontend
npm install
npm run build

# Docker ì´ë¯¸ì§€ ë¹Œë“œ
cd ..
docker build -t emba-app -f backend/Dockerfile .
```

### 4ë‹¨ê³„: Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰

```bash
docker run -d \
  --name emba-backend \
  -p 5000:5000 \
  -e NODE_ENV=production \
  -e JWT_SECRET=your-secret-key \
  -e PORT=5000 \
  -v $(pwd)/backend/data:/app/data \
  -v $(pwd)/backend/uploads:/app/uploads \
  emba-app
```

### 5ë‹¨ê³„: Docker Compose ì‚¬ìš© (ì„ íƒì‚¬í•­)

`docker-compose.yml` íŒŒì¼ ìƒì„±:

```yaml
version: '3.8'

services:
  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    ports:
      - "5000:5000"
    environment:
      - NODE_ENV=production
      - PORT=5000
      - JWT_SECRET=${JWT_SECRET}
    volumes:
      - ./backend/data:/app/data
      - ./backend/uploads:/app/uploads
    restart: unless-stopped
```

ì‹¤í–‰:
```bash
docker-compose up -d
```

---

## ğŸŒ ë°©ë²• 4: Nginxë¥¼ ì‚¬ìš©í•œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ (í”„ë¡œë•ì…˜ ê¶Œì¥)

### 1ë‹¨ê³„: Nginx ì„¤ì¹˜

```bash
sudo apt update
sudo apt install nginx
```

### 2ë‹¨ê³„: Nginx ì„¤ì • íŒŒì¼ ìƒì„±

`/etc/nginx/sites-available/emba` íŒŒì¼ ìƒì„±:

```nginx
server {
    listen 80;
    server_name your-domain.com;

    # í”„ë¡ íŠ¸ì—”ë“œ ì •ì  íŒŒì¼
    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # API ìš”ì²­
    location /api {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # ì—…ë¡œë“œ íŒŒì¼ í¬ê¸° ì œí•œ
    client_max_body_size 10M;
}
```

### 3ë‹¨ê³„: Nginx ì„¤ì • í™œì„±í™”

```bash
sudo ln -s /etc/nginx/sites-available/emba /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

### 4ë‹¨ê³„: HTTPS ì„¤ì • (Let's Encrypt)

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

---

## ğŸ“ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°°í¬ ì „
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì™„ë£Œ (`npm run build`)
- [ ] ë°±ì—”ë“œ ì˜ì¡´ì„± ì„¤ì¹˜ ì™„ë£Œ
- [ ] `.env` íŒŒì¼ ìƒì„± ë° ì„¤ì •
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… (ê¸°ì¡´ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°)
- [ ] í¬íŠ¸ ë°©í™”ë²½ ì„¤ì • í™•ì¸

### ë°°í¬ í›„
- [ ] ì„œë²„ê°€ ì •ìƒì ìœ¼ë¡œ ì‹œì‘ë˜ëŠ”ì§€ í™•ì¸
- [ ] `/api/health` ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í™•ì¸
- [ ] í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ ë¡œë“œ í™•ì¸
- [ ] ë¡œê·¸ì¸/íšŒì›ê°€ì… ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ ìƒì„± í™•ì¸

---

## ğŸ” ë¬¸ì œ í•´ê²°

### í¬íŠ¸ê°€ ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ê²½ìš°

```bash
# í¬íŠ¸ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
sudo lsof -i :5000
# ë˜ëŠ”
sudo netstat -tulpn | grep 5000

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
sudo kill -9 <PID>
```

### ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜

```bash
# ë°ì´í„° ë””ë ‰í† ë¦¬ ê¶Œí•œ í™•ì¸
ls -la backend/data
chmod 755 backend/data
```

### ë¹Œë“œ ì˜¤ë¥˜

```bash
# node_modules ì‚­ì œ í›„ ì¬ì„¤ì¹˜
rm -rf node_modules package-lock.json
npm install
```

### ì„œë²„ê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°

```bash
# ë¡œê·¸ í™•ì¸
pm2 logs emba-backend
# ë˜ëŠ”
tail -f server.log

# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
cat backend/.env
```

---

## ğŸ“ ë°°í¬ í›„ í™•ì¸ ëª…ë ¹ì–´

```bash
# ì„œë²„ ìƒíƒœ í™•ì¸
curl http://localhost:5000/api/health

# PM2 ìƒíƒœ í™•ì¸
pm2 status

# ë¡œê·¸ í™•ì¸
pm2 logs emba-backend

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ í™•ì¸
df -h

# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
free -h
```

---

## ğŸ‰ ë°°í¬ ì™„ë£Œ!

ë°°í¬ê°€ ì™„ë£Œë˜ë©´ ë‹¤ìŒ URLë¡œ ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ë¡œì»¬: `http://localhost:5000`
- ë„ë©”ì¸: `http://your-domain.com` (Nginx ì„¤ì • ì‹œ)

ê¸°ë³¸ ê´€ë¦¬ì ê³„ì •:
- ì•„ì´ë””: `admin`
- ë¹„ë°€ë²ˆí˜¸: `admin1234` (ë³€ê²½ ê¶Œì¥)

